# 사이킷런

## ----220225-----

### 분류(Classification) 프로세스

1. 데이터 세트 분리
2. 모델 학습
3. 예측 수행
4. 평가

### 사이킷런 기반 프레임 워크

* fit : ML 모델 학습을 위함

* predict : 학습된 모델의 예측을 위함

* Classifier와 Regressor를 Estimate 클래스라고 부름
* cross_val_score : evaluaion 함수
* GridSearchCV : 하이퍼 파라미터 튜닝을 지원하는 클래스
* fit_transform() : fit과 transform을 하나로 결합한 클래스

### model selection 모듈

* train_test_split() : 학습/테스트 데이터 세트 분리

### 교차검증

* 과적합 문제를 개선하기 위함
* 학습, 검증, 테스트 데이터 세트로 분리

#### K 폴드 교차 검증

* K개의 데이터 폴드 세트를 만든 후 K번 만큼 각 폴드 세티에 학습과 검증 평가를 반복적으로 수행하는 방법

#### stratified k 폴드

* 불균형한 분포도를 가진 레이블 데이터 집합을 위한 k폴드 방식
* 불균형한 분포도를 가진 데이터 집합은 특정 레이블 값이 특이하게 많거나 매우 적어서 값의 분포가 한쪽으로 치우치는 것을 말함
  * ex) 대출 사기 데이터
* 레이블 데이터 분포도에 따라 학습/검증 데이터를 나누기 때문에 split() 메서드에 인자로 피처데이터 세트 뿐 아니라 레이블 데이터 세트도 반드시 필요함

일반적으로 분류에서의 교차검증은 Kfold가 아닌 stratified k폴드로 분할되어야 함

회귀에서는 stratified kfold 미지원 - 레이블이 연속형 이기 때문

#### cross_val_score()

* 교차검증을 쉽게 수행할수 있게 만들어 주는 API
* API 내부에서 Estimator를 fit, predict, evaluation 시켜줌
* 내부적으로 stratified kfold를 이용함

### GridSearchCV 

* 교차 검증과 최적 하이퍼 파라미터 튜닝을 한번에 할수 있음



## -----220303-----

### preprocessing

#### LabelEncoding

* 문자형 피쳐를 숫자형 피쳐로 변환함
* ex) TV:1, 냉장고:2 등
* 레이블이 숫자로 바뀌면서 값에 가중치가 생김 -> 예측 확률 떨어질 가능성

#### onehotencoding

* 피쳐 값의 유형에 따라 새로운 피쳐를 추가하여 고유 값에 해당하는 칼럼에만 1을 표시하고 나머지 컬럼에는 0을 표시
* 변환하기 전 모든 문자열 값이 숫자형 값으로 변환돼야 함
* 입력값으로 2차원 데이터가 필요함
* 판다스를 이용해 원핫인코딩 가능 : 문자열 카테고리값을 숫자형으로 변환할 필요 없이 바로 변환 가능

### 정규화

#### standardscaler

* 개별 피쳐를 평균이 0이고 분산이 1인 값으로 변환해줌

#### minmaxscaler

* 데이터를 0과 1값 사이의 범위값으로 변환(음수 값이 있으면 -1에서 1값으로 변환)

#### 스케일링 변환 시 유의점

* 일반적으로 fit()은 데이터 변환을 위한 기중정보 설정을 적용(ex.데이터 세트의 최대값,최소값 등)
* transform()은 이렇게 선정한 정보를 통해 데이터를 변환
* **Scaler 객체를 이용해 학습 데이터 세트로 fit과 transform을 적용하면 테스트 데이터세트로는 다시 fit을 수행하지 않고 학습 데이터세트로 fit을 수행한 결과를 이용해 transform 변환을 적용해야함**



